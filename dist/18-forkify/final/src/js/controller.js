import*as model from"./model.js";import{MODAL_CLOSE_SEC}from"./config.js";import recipeView from"./views/recipeView.js";import searchView from"./views/searchView.js";import resultsView from"./views/resultsView.js";import paginationView from"./views/paginationView.js";import bookmarksView from"./views/bookmarksView.js";import addRecipeView from"./views/addRecipeView.js";import"core-js/stable";import"regenerator-runtime/runtime";import{async}from"regenerator-runtime";const controlRecipes=async function(){try{var e=window.location.hash.slice(1);e&&(recipeView.renderSpinner(),resultsView.update(model.getSearchResultsPage()),bookmarksView.update(model.state.bookmarks),await model.loadRecipe(e),recipeView.render(model.state.recipe))}catch(e){recipeView.renderError(),console.error(e)}},controlSearchResults=async function(){try{resultsView.renderSpinner();var e=searchView.getQuery();e&&(await model.loadSearchResults(e),resultsView.render(model.getSearchResultsPage()),paginationView.render(model.state.search))}catch(e){console.log(e)}},controlPagination=function(e){resultsView.render(model.getSearchResultsPage(e)),paginationView.render(model.state.search)},controlServings=function(e){model.updateServings(e),recipeView.update(model.state.recipe)},controlAddBookmark=function(){model.state.recipe.bookmarked?model.deleteBookmark(model.state.recipe.id):model.addBookmark(model.state.recipe),recipeView.update(model.state.recipe),bookmarksView.render(model.state.bookmarks)},controlBookmarks=function(){bookmarksView.render(model.state.bookmarks)},controlAddRecipe=async function(e){try{addRecipeView.renderSpinner(),await model.uploadRecipe(e),console.log(model.state.recipe),recipeView.render(model.state.recipe),addRecipeView.renderMessage(),bookmarksView.render(model.state.bookmarks),window.history.pushState(null,"","#"+model.state.recipe.id),setTimeout(function(){addRecipeView.toggleWindow()},1e3*MODAL_CLOSE_SEC)}catch(e){console.error("ðŸ’¥",e),addRecipeView.renderError(e.message)}},init=function(){bookmarksView.addHandlerRender(controlBookmarks),recipeView.addHandlerRender(controlRecipes),recipeView.addHandlerUpdateServings(controlServings),recipeView.addHandlerAddBookmark(controlAddBookmark),searchView.addHandlerSearch(controlSearchResults),paginationView.addHandlerClick(controlPagination),addRecipeView.addHandlerUpload(controlAddRecipe)};init();